{% load humanize %}
{% load static %}
{% include "ss/head.html" %}

<link rel="stylesheet" href="{% static 'css/quantri.css'%}">


<body>
    <!-- Sidebar -->
    <div class="sidebar" id="sidebar">
        <button class="toggle-btn" onclick="toggleSidebar()">
            <i class="bi bi-list"></i>
        </button>

        <h4 class="sidebar-title">
            Qu·∫£n L√Ω Shop
        </h4>

        <ul class="sidebar-menu">
                <li><a href="{% url 'qldm'%}"><i class="bi bi-folder-plus"></i> <span>Danh M·ª•c</span></a></li>
                <li><a href="{% url 'qlsp'%}"><i class="bi bi-bag-plus"></i> <span>S·∫£n Ph·∫©m</span></a></li>
                <li><a href="{% url 'qlncc'%}"><i class="bi bi-truck"></i> <span>Nh√† Cung C·∫•p</span></a></li>
                <li><a href="{% url 'qlnd'%}"><i class="bi bi-people"></i> <span>Ng∆∞·ªùi d√πng</span></a></li>
           
           
            
        </ul>
    </div>

    <!-- Main Content -->
    <div class="main-content">
        <div class="container py-5">
            <h2 class="mb-4 text-center">üìä Dashboard Qu·∫£n l√Ω ƒë∆°n h√†ng</h2>

            <!-- T·ªïng quan -->
            <div class="row text-center mb-4">
                <div class="col-md-4">
                    <div class="card p-3 shadow-sm">
                        <h5>T·ªïng ƒë∆°n</h5>
                        <h3>{{td}}</h3>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="card p-3 shadow-sm bg-warning-subtle">
                        <h5>ƒêang ch·ªù</h5>
                        <h3>{{dc}}</h3>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="card p-3 shadow-sm bg-warning-subtle">
                        <h5>ƒê√£ x√°c nh·∫≠n</h5>
                        <h3>{{dxn}}</h3>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="card p-3 shadow-sm bg-info-subtle">
                        <h5>ƒêang giao</h5>
                        <h3>{{dg}}</h3>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="card p-3 shadow-sm bg-success-subtle">
                        <h5>Ho√†n th√†nh</h5>
                        <h3>{{ht}}</h3>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="card p-3 shadow-sm bg-success-subtle">
                        <h5>ƒê∆°n h·ªßy</h5>
                        <h3>{{dh}}</h3>
                    </div>
                </div>
            </div>

            <div class="text-center mb-5">
                <h4>T·ªïng doanh thu: <span class="text-success">{{dt|floatformat:0|intcomma }} ƒë</span></h4>
            </div>

            <!-- Danh s√°ch ƒë∆°n h√†ng -->
            <div class="card shadow-sm">
                <div class="card-body">
                    <h5 class="card-title mb-3">Danh s√°ch ƒë∆°n h√†ng</h5>
                    <table class="table table-hover align-middle">
                        <thead class="table-light">
                            <tr>
                                <th>M√£</th>
                                <th>T√™n S·∫£n Ph·∫©m</th>
                                <th>Kh√°ch h√†ng</th>
                                <th>Ng√†y ƒë·∫∑t</th>
                                <th>T·ªïng ti·ªÅn</th>
                                <th>Tr·∫°ng th√°i</th>
                                <th>H√†nh ƒë·ªông</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for hd in ds %}
                            {% for ct in hd.cthd.all%}
                            <tr>
                                <td>{{hd.id}}</td>
                                <td>{{ct.size_sanpham.sanpham.ten_sp}}</td>
                                <td>{{hd.nguoidung.username}}</td>
                                <td>{{hd.ngay_tao|date:"d/m/Y H:i"}}</td>
                                <td>{{hd.tongcong|floatformat:0|intcomma}} ƒë</td>
                                <td>
                                    <span class="
                                {% if hd.trang_thai == 'pending' %} bg-warning text-dark
                                {% elif hd.trang_thai == 'confirmed' %} bg-info
                                {% elif hd.trang_thai == 'shipping' %} bg-primary
                                {% elif hd.trang_thai == 'delivered' %} bg-success
                                {% else %} bg-danger
                                {% endif %}
                            ">
                                        {{ hd.get_trang_thai_display }}
                                    </span>
                                </td>
                                <td>
                                    <form method="post" action="{% url 'cn' hd.id%}">
                                        {% csrf_token %}
                                        <select name="trang_thai" class="form-select form-select-sm d-inline w-auto">
                                            {% for val, text in hd.trangthai_choices %}
                                            <option value="{{val}}" {% if hd.trang_thai == val %} selected {%endif%}>
                                                {{text}}
                                            </option>
                                            {% endfor %}
                                        </select>
                                        <button class="btn btn-sm btn-outline-primary"> C·∫≠p nh·∫≠t</button>
                                    </form>
                                </td>
                            </tr>
                            {%endfor%}
                            {%endfor%}

                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
    <script src="{% static 'js/AllJS.js'%}"></script>
</body>
